name: Update release branch
on:
  push:
    branches: [ main, releases/next ]
jobs:
  update_release_branch:
    runs-on: ubuntu-latest
#     if: github.ref == 'refs/heads/main'
    steps:
    - name: Event summary
      run: |
        echo 'Event summary for ${{ github.job }}'
        echo 'Github head ref ${{github.github.head_ref}}'
        echo 'Github ref ${{github.github.ref}}'
        echo 'Github event ${{github.event}}'
    - name: Update git
      run: |
        sudo add-apt-repository -y ppa:git-core/ppa
        sudo apt-get update
        sudo apt-get install git -y
    - uses: actions/checkout@v2
      with:
        ref: releases/next
        token: ${{ github.token }}
        fetch-depth: 0
    - name: Merge changes from main
      run: |
        cd $GITHUB_WORKSPACE
        git fetch --tags
        git status
        git merge origin/main
        git push origin releases/next
  update_release_pr:
    runs-on: ubuntu-latest
#     if: github.ref == 'refs/heads/releases/next'
    steps:
    - name: Event summary
      run: |
        echo 'Event summary for ${{ github.job }}'
        echo 'Github head ref ${{github.github.head_ref}}'
        echo 'Github ref ${{github.github.ref}}'
        echo 'Github event ${{github.event}}'
        
